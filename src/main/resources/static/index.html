<!DOCTYPE html>
<html>
<body>
<style>
  .mono {
  font-family: monospace, monospace;
  }
  .red {
    color:red;
  }
</style>
<h1>Roman Number</h1>


<form name="form"">
    <label for="numberInput" id="inputLabel">Enter a positive integer, with no commas:</label>
    <input type="text" name="Number" id="numberInput" />
    <input type="submit" />
  </form>
<p>
<div id="romanValue" class="mono"></div>
<div id="errorValue" class="red"></div>
</p>
<p>In this implementation we are using the vinculum (horizontal overhead bar) to represent a value times 1000. So 10 is X and 10,000 is XÌ….</p>
<script>
    onpageshow = (event) => {
        const inputLabel = document.getElementById('inputLabel');
        const url = 'http://localhost:8080/romanLimits/';
        fetch(url)
    .then((response) => {
      return response.json();
    })
    .then((contents) => {
      let upper = contents.upperLimit;
      let lower = contents.lowerLimit;
      inputLabel.innerHTML = `Enter a positive integer, with no commas, between ${lower} and ${upper}:`;
    })
    .catch(function(error) {
      console.log(error);
    });
    }

    document.querySelector('form').addEventListener('submit', (e) => {
       e.preventDefault();  
       const data = Object.fromEntries(new FormData(e.target).entries());
       console.log(data);
       setPage(data);
       return false;
    });

function setPage(val){
  const valueDiv = document.getElementById('romanValue');
  const errorDiv = document.getElementById('errorValue');
  const baseUrl = 'http://localhost:8080/roman/';

  let url = baseUrl+val.Number;
  
  fetch(url)
    .then((response) => {
      return response.json();
    })
    .then((contents) => {
      let number = contents.value;
      let errorVal = contents.error;  
      valueDiv.innerHTML = `${number}`;
      errorDiv.innerHTML = `${errorVal}`;
    })
    .catch(function(error) {
      console.log(error);
    });
  }
    
</script>
</body>
</html>